%h2="Archivos para para revisión <strong>#{@revision.nombre}</strong>"
=@modal_archivos.javascript_header
/ Modal
=@modal_archivos.html_modal


%ul.breadcrumb
  %li
    %a{:href=>url("/revision/#{@revision.id}")}=@revision.nombre
  %li{:class=>:active}Archivos


%h3 Subir archivos

%form{:method=>:post, :action=>url("/revision/archivos/agregar"), :enctype=>'multipart/form-data'}
  %input{:type=>"hidden", :name=>"revision_sistematica_id",:value=>@revision[:id]}
  .form-group
    %label Archivo
    %input{:type=>'file', :name=>'archivos[]', :multiple=>"multiple"}
  %input{:type=>:submit, :class=>"btn btn-primary",:value=>"Enviar"}


%h3 Archivos
%p
  %strong Total:
  =@archivos_rs.count


%div{:class=>"btn-group btn-group-sm", :role=>'group'}
  %a{:role=>:button, :href=>url("/archivos/rs/#{@revision.id}/asignar_canonicos_documentos"), :class=>"btn btn-default"}
    %span{:class=>"glyphicon glyphicon-king"}
    Asignar a Documentos Canónicos

%table.reporte
  %thead
    %th Nombre
    %th Tipo
    %th Documento Canónico
    %th Acciones
  %tbody
    -@archivos_rs.each do |archivo|
      %tr
        %td{:style=>'max-width:300px;overflow:hidden;text-overflow:ellipsis;'}
          =a_editable(archivo[:id], 'archivo_nombre', "/archivo/editar_campo/archivo_nombre", archivo[:archivo_nombre])
        %td
          =a_editable(archivo[:id], 'archivo_tipo', "/archivo/editar_campo/archivo_tipo", archivo[:archivo_tipo])
        %td{:id=>"nombre_canonico-#{archivo[:id]}"}
          -if archivo[:canonico_documento_id]
            %a{:href=>"/canonico_documento/#{archivo[:canonico_documento_id]}"}=@canonicos_documentos_h[archivo[:canonico_documento_id]] ? @canonicos_documentos_h[archivo[:canonico_documento_id]].title : "<em>SIN TÍTULO</em>"
          -else
            %select{:id=>"select_canonico_#{archivo[:id]}",:name=>"select_canonico_#{archivo[:id]}[]"}
              %option{:value=>""}--Sin canónico--
              -@cd_validos.each do |cd|
                %option{:value=>cd[:id]}=CGI.escapeHTML(cd[:title][0..50])
            %button.btn.btn-default.btn-sm.asignar_canonico{"archivo-pk"=>archivo[:id]}
              Cambiar

        %td=@modal_archivos.botones(archivo,archivo[:canonico_documento_id],@revision.id,true)